{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/**\n * PersonalTools container.\n * @module components/manage/Toolbar/PersonalTools\n */\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport jwtDecode from 'jwt-decode';\nimport cx from 'classnames';\nimport { FormattedMessage, injectIntl, defineMessages } from 'react-intl';\nimport { Icon } from '@plone/volto/components';\nimport { getUser } from '@plone/volto/actions';\nimport { Pluggable } from '@plone/volto/components/manage/Pluggable';\nimport { expandToBackendURL, getBaseUrl, userHasRoles } from '@plone/volto/helpers';\nimport { withRouter } from 'react-router-dom';\nimport { compose } from 'redux';\nimport logoutSVG from '@plone/volto/icons/log-out.svg';\nimport rightArrowSVG from '@plone/volto/icons/right-key.svg';\nimport backSVG from '@plone/volto/icons/back.svg';\nimport cameraSVG from '@plone/volto/icons/camera.svg';\nconst messages = defineMessages({\n  back: {\n    \"id\": \"Back\",\n    \"defaultMessage\": \"Back\"\n  },\n  logout: {\n    \"id\": \"Logout\",\n    \"defaultMessage\": \"Logout\"\n  },\n  preferences: {\n    \"id\": \"Preferences\",\n    \"defaultMessage\": \"Preferences\"\n  },\n  profile: {\n    \"id\": \"Profile\",\n    \"defaultMessage\": \"Profile\"\n  },\n  userAvatar: {\n    \"id\": \"user avatar\",\n    \"defaultMessage\": \"user avatar\"\n  }\n});\n/**\n * Toolbar container class.\n * @class PersonalTools\n * @extends Component\n */\n\nclass PersonalTools extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"push\", selector => {\n      this.setState(() => ({\n        pushed: true\n      }));\n      this.props.loadComponent(selector);\n    });\n\n    _defineProperty(this, \"pull\", () => {\n      this.props.unloadComponent();\n    });\n  }\n\n  /**\n   * Property types.\n   * @property {Object} propTypes Property types.\n   * @static\n   */\n  componentDidMount() {\n    this.props.getUser(this.props.userId);\n  }\n\n  /**\n   * Render method.\n   * @method render\n   * @returns {string} Markup for the component.\n   */\n  render() {\n    return __jsx(\"div\", {\n      className: cx('personal-tools pastanaga-menu', {\n        'has-inner-actions': this.props.hasActions\n      }),\n      style: {\n        flex: this.props.theToolbar.current ? `0 0 ${this.props.theToolbar.current.getBoundingClientRect().width}px` : null\n      }\n    }, __jsx(\"header\", {\n      className: \"header\"\n    }, __jsx(\"button\", {\n      className: \"back\",\n      onClick: this.pull\n    }, __jsx(Icon, {\n      name: backSVG,\n      size: \"30px\",\n      title: this.props.intl.formatMessage(messages.back)\n    })), __jsx(\"div\", {\n      className: \"vertical divider\"\n    }), __jsx(\"h2\", null, this.props.user.fullname ? this.props.user.fullname : this.props.user.username), __jsx(Link, {\n      id: \"toolbar-logout\",\n      to: `${getBaseUrl(this.props.pathname)}/logout`\n    }, __jsx(Icon, {\n      className: \"logout\",\n      name: logoutSVG,\n      size: \"30px\",\n      title: this.props.intl.formatMessage(messages.logout)\n    }))), __jsx(\"div\", {\n      className: cx('avatar', {\n        default: !this.props.user.portrait\n      })\n    }, this.props.user.portrait ? __jsx(\"img\", {\n      src: expandToBackendURL(this.props.user.portrait),\n      alt: this.props.intl.formatMessage(messages.userAvatar)\n    }) : __jsx(Icon, {\n      name: cameraSVG,\n      size: \"96px\"\n    })), __jsx(\"div\", {\n      className: \"pastanaga-menu-list\"\n    }, __jsx(\"ul\", null, __jsx(\"li\", null, __jsx(Link, {\n      id: this.props.intl.formatMessage(messages.profile),\n      to: \"/personal-information\"\n    }, __jsx(FormattedMessage, {\n      id: \"Profile\",\n      defaultMessage: \"Profile\"\n    }), __jsx(Icon, {\n      name: rightArrowSVG,\n      size: \"24px\"\n    }))), __jsx(\"li\", null, __jsx(\"button\", {\n      \"aria-label\": this.props.intl.formatMessage(messages.preferences),\n      onClick: () => this.push('preferences')\n    }, __jsx(FormattedMessage, {\n      id: \"Preferences\",\n      defaultMessage: \"Preferences\"\n    }), __jsx(Icon, {\n      name: rightArrowSVG,\n      size: \"24px\"\n    }))), userHasRoles(this.props.user, ['Site Administrator', 'Manager']) && __jsx(\"li\", null, __jsx(Link, {\n      to: \"/controlpanel\"\n    }, __jsx(FormattedMessage, {\n      id: \"Site Setup\",\n      defaultMessage: \"Site Setup\"\n    }), __jsx(Icon, {\n      name: rightArrowSVG,\n      size: \"24px\"\n    }))), __jsx(Pluggable, {\n      name: \"toolbar-user-menu\"\n    }))));\n  }\n\n}\n\nexport default compose(injectIntl, withRouter, connect((state, props) => ({\n  pathname: props.location.pathname,\n  user: state.users.user,\n  userId: state.userSession.token ? jwtDecode(state.userSession.token).sub : ''\n}), {\n  getUser\n}))(PersonalTools);","map":{"version":3,"names":["React","Component","connect","Link","jwtDecode","cx","FormattedMessage","injectIntl","defineMessages","Icon","getUser","Pluggable","expandToBackendURL","getBaseUrl","userHasRoles","withRouter","compose","logoutSVG","rightArrowSVG","backSVG","cameraSVG","messages","back","logout","preferences","profile","userAvatar","PersonalTools","selector","setState","pushed","props","loadComponent","unloadComponent","componentDidMount","userId","render","hasActions","flex","theToolbar","current","getBoundingClientRect","width","pull","intl","formatMessage","user","fullname","username","pathname","default","portrait","push","state","location","users","userSession","token","sub"],"sources":["/home/valentina/Plone/plone-conference/frontend/node_modules/@plone/volto/src/components/manage/Toolbar/PersonalTools.jsx"],"sourcesContent":["/**\n * PersonalTools container.\n * @module components/manage/Toolbar/PersonalTools\n */\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport jwtDecode from 'jwt-decode';\nimport cx from 'classnames';\nimport { FormattedMessage, injectIntl, defineMessages } from 'react-intl';\nimport { Icon } from '@plone/volto/components';\nimport { getUser } from '@plone/volto/actions';\nimport { Pluggable } from '@plone/volto/components/manage/Pluggable';\nimport {\n  expandToBackendURL,\n  getBaseUrl,\n  userHasRoles,\n} from '@plone/volto/helpers';\nimport { withRouter } from 'react-router-dom';\nimport { compose } from 'redux';\n\nimport logoutSVG from '@plone/volto/icons/log-out.svg';\nimport rightArrowSVG from '@plone/volto/icons/right-key.svg';\n\nimport backSVG from '@plone/volto/icons/back.svg';\nimport cameraSVG from '@plone/volto/icons/camera.svg';\n\nconst messages = defineMessages({\n  back: {\n    id: 'Back',\n    defaultMessage: 'Back',\n  },\n  logout: {\n    id: 'Logout',\n    defaultMessage: 'Logout',\n  },\n  preferences: {\n    id: 'Preferences',\n    defaultMessage: 'Preferences',\n  },\n  profile: {\n    id: 'Profile',\n    defaultMessage: 'Profile',\n  },\n  userAvatar: {\n    id: 'user avatar',\n    defaultMessage: 'user avatar',\n  },\n});\n\n/**\n * Toolbar container class.\n * @class PersonalTools\n * @extends Component\n */\nclass PersonalTools extends Component {\n  /**\n   * Property types.\n   * @property {Object} propTypes Property types.\n   * @static\n   */\n  static propTypes = {\n    user: PropTypes.shape({\n      fullname: PropTypes.string,\n      email: PropTypes.string,\n      home_page: PropTypes.string,\n      location: PropTypes.string,\n    }).isRequired,\n    userId: PropTypes.string.isRequired,\n    getUser: PropTypes.func.isRequired,\n    loadComponent: PropTypes.func.isRequired,\n  };\n\n  componentDidMount() {\n    this.props.getUser(this.props.userId);\n  }\n\n  push = (selector) => {\n    this.setState(() => ({\n      pushed: true,\n    }));\n    this.props.loadComponent(selector);\n  };\n\n  pull = () => {\n    this.props.unloadComponent();\n  };\n\n  /**\n   * Render method.\n   * @method render\n   * @returns {string} Markup for the component.\n   */\n  render() {\n    return (\n      <div\n        className={cx('personal-tools pastanaga-menu', {\n          'has-inner-actions': this.props.hasActions,\n        })}\n        style={{\n          flex: this.props.theToolbar.current\n            ? `0 0 ${\n                this.props.theToolbar.current.getBoundingClientRect().width\n              }px`\n            : null,\n        }}\n      >\n        <header className=\"header\">\n          <button className=\"back\" onClick={this.pull}>\n            <Icon\n              name={backSVG}\n              size=\"30px\"\n              title={this.props.intl.formatMessage(messages.back)}\n            />\n          </button>\n          <div className=\"vertical divider\" />\n          <h2>\n            {this.props.user.fullname\n              ? this.props.user.fullname\n              : this.props.user.username}\n          </h2>\n          <Link\n            id=\"toolbar-logout\"\n            to={`${getBaseUrl(this.props.pathname)}/logout`}\n          >\n            <Icon\n              className=\"logout\"\n              name={logoutSVG}\n              size=\"30px\"\n              title={this.props.intl.formatMessage(messages.logout)}\n            />\n          </Link>\n        </header>\n        <div className={cx('avatar', { default: !this.props.user.portrait })}>\n          {this.props.user.portrait ? (\n            <img\n              src={expandToBackendURL(this.props.user.portrait)}\n              alt={this.props.intl.formatMessage(messages.userAvatar)}\n            />\n          ) : (\n            <Icon name={cameraSVG} size=\"96px\" />\n          )}\n        </div>\n        {/* <Stats /> Maybe we can find a good fit in the future for this visual element */}\n        <div className=\"pastanaga-menu-list\">\n          {/* This (probably also) should be a Component by itself*/}\n          <ul>\n            <li>\n              <Link\n                id={this.props.intl.formatMessage(messages.profile)}\n                to=\"/personal-information\"\n              >\n                <FormattedMessage id=\"Profile\" defaultMessage=\"Profile\" />\n                <Icon name={rightArrowSVG} size=\"24px\" />\n              </Link>\n            </li>\n            <li>\n              <button\n                aria-label={this.props.intl.formatMessage(messages.preferences)}\n                onClick={() => this.push('preferences')}\n              >\n                <FormattedMessage\n                  id=\"Preferences\"\n                  defaultMessage=\"Preferences\"\n                />\n                <Icon name={rightArrowSVG} size=\"24px\" />\n              </button>\n            </li>\n\n            {userHasRoles(this.props.user, [\n              'Site Administrator',\n              'Manager',\n            ]) && (\n              <li>\n                <Link to=\"/controlpanel\">\n                  <FormattedMessage\n                    id=\"Site Setup\"\n                    defaultMessage=\"Site Setup\"\n                  />\n                  <Icon name={rightArrowSVG} size=\"24px\" />\n                </Link>\n              </li>\n            )}\n            <Pluggable name=\"toolbar-user-menu\" />\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default compose(\n  injectIntl,\n  withRouter,\n  connect(\n    (state, props) => ({\n      pathname: props.location.pathname,\n      user: state.users.user,\n      userId: state.userSession.token\n        ? jwtDecode(state.userSession.token).sub\n        : '',\n    }),\n    { getUser },\n  ),\n)(PersonalTools);\n"],"mappings":"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"},"metadata":{"react-intl":{"messages":[{"id":"Back","defaultMessage":"Back"},{"id":"Logout","defaultMessage":"Logout"},{"id":"Preferences","defaultMessage":"Preferences"},{"id":"Profile","defaultMessage":"Profile"},{"id":"user avatar","defaultMessage":"user avatar"},{"id":"Site Setup","defaultMessage":"Site Setup"}]}},"sourceType":"module"}